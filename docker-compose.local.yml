version: '3.8'

# Local development docker-compose override for satori-lite
# Usage: docker-compose -f ../docker-compose.yml -f docker-compose.local.yml up

services:
  # Satori-Lite Web UI + Neuron
  satori-lite:
    build:
      context: ./satori-lite
      dockerfile: Dockerfile
    container_name: satori-lite
    environment:
      # Connect to the API server (use container name for local, remote URL for production)
      SATORI_CENTRAL_URL: http://satori-api:8000
      # Wallet/vault paths inside container
      WALLET_PATH: /data/wallet.yaml
      VAULT_PATH: /data/vault.yaml
      # Flask config
      SECRET_KEY: local-dev-secret-key-change-in-production
      WEB_PORT: 24601
      # P2P Networking Mode: central (default), hybrid, or p2p
      # SATORI_NETWORKING_MODE: central
    volumes:
      # Persist wallet data
      - ./data:/data
      # Mount code for live reload (optional, remove for production-like)
      # - ./web:/Satori/web
      # - ./neuron-lite:/Satori/Neuron
    ports:
      - "24601:24601"
      - "24600:24600"  # P2P port (when networking mode is hybrid or p2p)
    depends_on:
      api:
        condition: service_started
    networks:
      - default
    command: python /Satori/Neuron/start.py

networks:
  default:
    name: app_default
    external: true
